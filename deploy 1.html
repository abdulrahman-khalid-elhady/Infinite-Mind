<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>INFINITE MIND V20: ULTIMATE EDITION</title>
    <link rel="icon" type="image/svg+xml" href="
data:image/svg+xml,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
  <defs>
    <linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>
      <stop offset='0%' stop-color='%235f6cff'/>
      <stop offset='50%' stop-color='%23962fbf'/>
      <stop offset='100%' stop-color='%23fa7e1e'/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width='100' height='100' rx='24' fill='%23050505'/>

  <!-- Core -->
  <circle cx='50' cy='50' r='26' fill='url(%23g)'/>

  <!-- Focus Cut -->
  <rect x='47' y='24' width='6' height='52' rx='3' fill='%23050505'/>
</svg>
">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* --- DESIGN SYSTEM: CLASSY DARK (ENHANCED) --- */
        :root {
            --bg: #050505;
            --surface: #121212;
            --surface-light: #1e1e1e;
            --primary: #4f5bd5;
            --accent: #962fbf;
            --gold: #fa7e1e;
            --success: #00d26a;
            --text: #ffffff;
            --text-dim: #888888;
            --font: "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --ease: cubic-bezier(0.23, 1, 0.32, 1);
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; background-color: var(--bg); color: var(--text);
            font-family: var(--font); overflow: hidden; height: 100vh;
            display: flex; flex-direction: column;
        }

        /* LAYOUT */
        #layout { flex: 1; display: flex; flex-direction: column; position: relative; }

        /* HEADER */
        .header { padding: 20px 30px; display: flex; justify-content: space-between; align-items: center; z-index: 20; flex-wrap: wrap; gap: 15px; }
        .score-box .label { font-size: 11px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 2px; }
        .score-box .value { font-size: 36px; font-weight: 800; letter-spacing: -1px; }

        .flow-badge {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 800;
            opacity: 0; transform: translateY(20px); transition: all 0.4s var(--ease);
            box-shadow: 0 5px 20px rgba(79, 91, 213, 0.4);
        }
        .flow-badge.active { opacity: 1; transform: translateY(0); }

        .streak-badge {
            background: linear-gradient(135deg, var(--gold), #ff9500);
            padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 800;
            box-shadow: 0 5px 20px rgba(250, 126, 30, 0.4);
        }

        /* TIMER */
        .timer-wrap { position: absolute; top: 0; left: 0; width: 100%; height: 4px; background: rgba(255,255,255,0.05); }
        .timer-bar { height: 100%; background: var(--text); width: 100%; transform-origin: left; transition: background 0.2s; }

        /* STAGE */
        .stage { flex: 1; display: flex; position: relative; }
        .divider { position: absolute; left: 50%; top: 15%; bottom: 15%; width: 1px; background: linear-gradient(to bottom, transparent, var(--surface-light), transparent); }

        /* ZONES */
        .zone { flex: 1; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: background 0.1s; position: relative; }
        .zone:active { background: rgba(255,255,255,0.04); }

        /* PROMPT (The Clean Central Box) */
        .prompt {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(18, 18, 18, 0.95); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            padding: 20px 50px; border-radius: 40px; border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            display: flex; flex-direction: column; align-items: center; gap: 8px;
            z-index: 30; pointer-events: none; min-width: 260px; text-align: center;
        }
        .prompt-label { font-size: 11px; color: var(--gold); text-transform: uppercase; letter-spacing: 3px; font-weight: 700; }
        .prompt-main { font-size: 20px; font-weight: 700; color: var(--text); white-space: nowrap; letter-spacing: 0.5px; }

        /* ENTITIES (Clean & Large) */
        .entity {
            font-size: 70px; font-weight: 700; transition: transform 0.4s var(--ease);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; width: 100%; padding: 20px;
        }
        .text-mode { font-size: 32px; letter-spacing: 1px; font-weight: 600; color: #eee; }
        .math-mode { font-size: 50px; font-family: monospace; letter-spacing: -2px; }
        
        /* 3D Looking Emojis */
        .emoji-mode { 
            font-size: 100px; 
            filter: drop-shadow(0 15px 25px rgba(0,0,0,0.6)); 
            transform: scale(1);
            transition: transform 0.3s;
        }
        
        .sub-text {
            font-size: 15px; color: var(--text-dim); margin-top: 20px; 
            font-weight: 500; text-transform: uppercase; letter-spacing: 1px;
        }

        /* OVERLAYS */
        .overlay {
            position: fixed; inset: 0; z-index: 100; background: rgba(0,0,0,0.95);
            backdrop-filter: blur(15px); display: flex; flex-direction: column;
            justify-content: flex-start; align-items: center; transition: opacity 0.4s;
            overflow-y: auto;
            padding: 40px 20px;
        }
        .hidden { opacity: 0; pointer-events: none; }
        
        .overlay-content {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        
        h1 { 
            font-size: 60px; 
            margin: 0 0 10px 0; 
            background: linear-gradient(to right, #fff, #888); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            letter-spacing: -3px;
            text-align: center;
        }
        
        .btn {
            background: white; color: black; border: none; padding: 18px 50px;
            border-radius: 50px; font-size: 18px; font-weight: 700; cursor: pointer;
            margin-top: 30px; transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }

        .btn-secondary {
            background: var(--surface-light); color: white; border: 1px solid rgba(255,255,255,0.2);
            padding: 14px 35px; border-radius: 50px; font-size: 16px; font-weight: 600;
            cursor: pointer; margin: 10px; transition: all 0.2s;
        }
        .btn-secondary:hover { background: var(--surface); transform: scale(1.05); }
        .btn-secondary:active { transform: scale(0.95); }

        /* CATEGORY SELECTION */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            max-width: 1000px;
            width: 95%;
            margin: 20px auto;
            padding: 0 10px;
        }

        .category-card {
            background: var(--surface);
            border: 2px solid transparent;
            border-radius: 16px;
            padding: 16px 12px;
            cursor: pointer;
            transition: all 0.3s var(--ease);
            text-align: center;
        }

        .category-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(79, 91, 213, 0.3);
        }

        .category-card.selected {
            border-color: var(--success);
            background: rgba(0, 210, 106, 0.1);
        }

        .category-icon {
            font-size: 35px;
            margin-bottom: 8px;
        }

        .category-name {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .category-desc {
            font-size: 11px;
            color: var(--text-dim);
        }

        .selection-summary {
            margin: 15px 0;
            padding: 12px 25px;
            background: var(--surface-light);
            border-radius: 25px;
            font-size: 13px;
            color: var(--text-dim);
        }

        .quick-select-btns {
            display: flex;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* DIFFICULTY SELECTOR */
        .difficulty-selector {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .difficulty-btn {
            padding: 12px 30px;
            border-radius: 25px;
            border: 2px solid rgba(255,255,255,0.2);
            background: var(--surface);
            color: var(--text);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .difficulty-btn:hover {
            border-color: var(--primary);
        }

        .difficulty-btn.selected {
            background: var(--primary);
            border-color: var(--primary);
        }

        /* PARTICLES */
        .particle { position: absolute; pointer-events: none; border-radius: 50%; animation: pop 0.6s ease-out forwards; }
        @keyframes pop { to { transform: translate(var(--dx), var(--dy)); opacity: 0; } }

        /* HINT BUTTON */
        .hint-btn {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--text);
            padding: 10px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            z-index: 25;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .hint-btn:hover {
            background: rgba(255,255,255,0.15);
            transform: translateX(-50%) scale(1.05);
        }

        .hint-btn:active {
            transform: translateX(-50%) scale(0.95);
        }

        .hint-btn.used {
            opacity: 0.3;
            pointer-events: none;
        }

        /* PAUSE BUTTON */
        .pause-btn {
            position: fixed;
            top: 25px;
            right: 30px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--text);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            z-index: 25;
            transition: all 0.3s;
        }

        .pause-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        @media (max-width: 768px) {
            .category-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
            h1 { font-size: 40px; }
            .entity { font-size: 50px; }
            .emoji-mode { font-size: 70px; }
        }

        /* CUSTOM SCROLLBAR - DARK THEME */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--surface-light);
            border-radius: 10px;
            border: 2px solid var(--bg);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Firefox scrollbar */
        * {
            scrollbar-width: thin;
            scrollbar-color: var(--surface-light) var(--bg);
        }
    </style>
</head>
<body>

    <!-- START SCREEN -->
    <div class="overlay" id="start-screen">
        <div class="overlay-content" style="justify-content: center;">
            <div style="font-size: 14px; letter-spacing: 4px; color: var(--gold); margin-bottom: 10px;">V20 ULTIMATE</div>
            <h1>INFINITE MIND</h1>
            <p style="color:var(--text-dim); font-size: 16px;">Enhanced Edition with 20+ Categories</p>
            <button class="btn" onclick="Game.showCategorySelection()">START GAME</button>
            <button class="btn-secondary" onclick="Game.showInfo()">HOW TO PLAY</button>
        </div>
    </div>

    <!-- CATEGORY SELECTION -->
    <div class="overlay hidden" id="category-screen">
        <div class="overlay-content">
            <div style="font-size: 14px; letter-spacing: 4px; color: var(--gold); margin-bottom: 10px;">SELECT CATEGORIES</div>
            <h1 style="font-size: 40px;">CHOOSE YOUR CHALLENGE</h1>
            
            <div class="quick-select-btns">
                <button class="btn-secondary" onclick="Game.selectAllCategories()">SELECT ALL</button>
                <button class="btn-secondary" onclick="Game.clearCategories()">CLEAR ALL</button>
                <button class="btn-secondary" onclick="Game.selectRandom(5)">RANDOM 5</button>
                <button class="btn-secondary" onclick="Game.selectByType('knowledge')">KNOWLEDGE ONLY</button>
                <button class="btn-secondary" onclick="Game.selectByType('math')">MATH ONLY</button>
                <button class="btn-secondary" onclick="Game.selectByType('logic')">LOGIC ONLY</button>
            </div>

            <div class="selection-summary" id="selection-summary">
                <span id="selected-count">0</span> categories selected
            </div>

            <div class="category-grid" id="category-grid"></div>

            <div style="margin-top: 30px;">
                <div style="font-size: 14px; color: var(--text-dim); margin-bottom: 15px;">DIFFICULTY LEVEL</div>
                <div class="difficulty-selector">
                    <div class="difficulty-btn selected" onclick="Game.setDifficulty('normal')" data-difficulty="normal">
                        NORMAL
                    </div>
                    <div class="difficulty-btn" onclick="Game.setDifficulty('hard')" data-difficulty="hard">
                        HARD
                    </div>
                    <div class="difficulty-btn" onclick="Game.setDifficulty('extreme')" data-difficulty="extreme">
                        EXTREME
                    </div>
                </div>
            </div>

            <button class="btn" onclick="Game.startWithSelection()" style="margin-top: 30px;">START GAME</button>
            <button class="btn-secondary" onclick="Game.backToStart()">BACK</button>
        </div>
    </div>

    <!-- INFO SCREEN -->
    <div class="overlay hidden" id="info-screen">
        <div class="overlay-content" style="justify-content: center;">
            <h1 style="font-size: 40px;">HOW TO PLAY</h1>
            <div style="max-width: 600px; text-align: left; padding: 30px; line-height: 1.8;">
                <p>üéØ <strong>Goal:</strong> Choose the correct answer based on the prompt</p>
                <p>‚è±Ô∏è <strong>Timer:</strong> Answer before time runs out. Speed increases with score!</p>
                <p>‚ú® <strong>Streak:</strong> Build combos for bonus points</p>
                <p>üí° <strong>Hint:</strong> Use once per game to eliminate wrong answer</p>
                <p>üéÆ <strong>Categories:</strong> Mix knowledge, logic, and quick thinking</p>
                <p>üèÜ <strong>Difficulty:</strong> Normal, Hard, or Extreme mode</p>
            </div>
            <button class="btn" onclick="Game.hideInfo()">GOT IT</button>
        </div>
    </div>

    <!-- END SCREEN -->
    <div class="overlay hidden" id="end-screen">
        <div class="overlay-content" style="justify-content: center;">
            <div style="font-size: 12px; color: var(--text-dim); letter-spacing: 2px;">GAME OVER</div>
            <h1 id="final-score">0</h1>
            <p id="end-reason" style="color: var(--text-dim); font-size: 18px; margin: 10px 0;">Focus Broken</p>
            <div id="stats-display" style="margin: 20px 0; color: var(--text-dim); font-size: 14px;"></div>
            <button class="btn" onclick="Game.restart()">PLAY AGAIN</button>
            <button class="btn-secondary" onclick="Game.backToStart()">MAIN MENU</button>
        </div>
    </div>

    <!-- GAME LAYOUT -->
    <div id="layout" class="hidden">
        <div class="timer-wrap"><div class="timer-bar" id="timer"></div></div>
        
        <div class="header">
            <div class="score-box">
                <div class="label">Score</div>
                <div class="value" id="score">0</div>
            </div>
            <div class="streak-badge" id="streak">üî• 0 Streak</div>
            <div class="flow-badge" id="flow">ZEN FLOW</div>
        </div>

        <div class="stage">
            <div class="divider"></div>
            
            <div class="prompt">
                <div class="prompt-label" id="p-label">Find</div>
                <div class="prompt-main" id="p-main">Target</div>
            </div>

            <div class="zone" onclick="Game.input('left')">
                <div class="entity" id="ent-left"></div>
            </div>

            <div class="zone" onclick="Game.input('right')">
                <div class="entity" id="ent-right"></div>
            </div>
        </div>

        <button class="hint-btn" id="hint-btn" onclick="Game.useHint()">üí° HINT (1)</button>
        <button class="pause-btn" onclick="Game.pause()">‚è∏</button>
    </div>

    <!-- PAUSE SCREEN -->
    <div class="overlay hidden" id="pause-screen">
        <div class="overlay-content" style="justify-content: center;">
            <h1 style="font-size: 40px;">PAUSED</h1>
            <p style="color: var(--text-dim);">Take a breath</p>
            <button class="btn" onclick="Game.resume()">RESUME</button>
            <button class="btn-secondary" onclick="Game.quitToMenu()">QUIT TO MENU</button>
        </div>
    </div>

<script>
    /**
     * INFINITE MIND V20: ULTIMATE EDITION
     * - 20+ Diverse Categories
     * - Category Selection System
     * - Difficulty Modes
     * - Hints & Features
     * - Improved Answer Validation
     * - No Repetition System
     */

    const AudioEngine = {
        ctx: new (window.AudioContext || window.webkitAudioContext)(),
        play(freq, type, dur) {
            try {
                if(this.ctx.state === 'suspended') this.ctx.resume();
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = type; osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + dur);
                osc.connect(gain); gain.connect(this.ctx.destination);
                osc.start(); osc.stop(this.ctx.currentTime + dur);
            } catch(e) {}
        },
        hit() { this.play(800, 'sine', 0.1); setTimeout(()=>this.play(1200,'sine',0.05), 40); },
        fail() { this.play(150, 'sawtooth', 0.3); this.play(120, 'sawtooth', 0.3); },
        hint() { this.play(600, 'sine', 0.15); }
    };

    // ========== DATABASE ==========
    const DB = {
        // Population data (millions) - EXPANDED
        countries: [
            {n:"China",v:1400,e:"üá®üá≥"}, {n:"India",v:1380,e:"üáÆüá≥"}, {n:"USA",v:331,e:"üá∫üá∏"},
            {n:"Indonesia",v:273,e:"üáÆüá©"}, {n:"Pakistan",v:225,e:"üáµüá∞"}, {n:"Brazil",v:213,e:"üáßüá∑"},
            {n:"Nigeria",v:211,e:"üá≥üá¨"}, {n:"Bangladesh",v:166,e:"üáßüá©"}, {n:"Russia",v:146,e:"üá∑üá∫"},
            {n:"Mexico",v:130,e:"üá≤üáΩ"}, {n:"Japan",v:126,e:"üáØüáµ"}, {n:"Egypt",v:104,e:"üá™üá¨"},
            {n:"Germany",v:83,e:"üá©üá™"}, {n:"UK",v:68,e:"üá¨üáß"}, {n:"France",v:65,e:"üá´üá∑"},
            {n:"Italy",v:60,e:"üáÆüáπ"}, {n:"South Africa",v:60,e:"üáøüá¶"}, {n:"South Korea",v:52,e:"üá∞üá∑"},
            {n:"Spain",v:47,e:"üá™üá∏"}, {n:"Canada",v:38,e:"üá®üá¶"}, {n:"Australia",v:26,e:"üá¶üá∫"},
            {n:"Argentina",v:45,e:"üá¶üá∑"}, {n:"Poland",v:38,e:"üáµüá±"}, {n:"Ukraine",v:44,e:"üá∫üá¶"},
            {n:"Morocco",v:37,e:"üá≤üá¶"}, {n:"Saudi Arabia",v:35,e:"üá∏üá¶"}, {n:"Peru",v:33,e:"üáµüá™"},
            {n:"Malaysia",v:33,e:"üá≤üáæ"}, {n:"Angola",v:33,e:"üá¶üá¥"}, {n:"Ghana",v:31,e:"üá¨üá≠"},
            {n:"Yemen",v:30,e:"üáæüá™"}, {n:"Nepal",v:30,e:"üá≥üáµ"}, {n:"Venezuela",v:28,e:"üáªüá™"},
            {n:"Madagascar",v:28,e:"üá≤üá¨"}, {n:"Cameroon",v:27,e:"üá®üá≤"}, {n:"Niger",v:25,e:"üá≥üá™"},
            {n:"Australia",v:26,e:"üá¶üá∫"}, {n:"Syria",v:18,e:"üá∏üáæ"}, {n:"Mali",v:21,e:"üá≤üá±"},
            {n:"Chile",v:19,e:"üá®üá±"}, {n:"Romania",v:19,e:"üá∑üá¥"}, {n:"Netherlands",v:17,e:"üá≥üá±"},
            {n:"Belgium",v:11,e:"üáßüá™"}, {n:"Greece",v:10,e:"üá¨üá∑"}, {n:"Portugal",v:10,e:"üáµüáπ"},
            {n:"Sweden",v:10,e:"üá∏üá™"}, {n:"UAE",v:10,e:"üá¶üá™"}, {n:"Austria",v:9,e:"üá¶üáπ"},
            {n:"Switzerland",v:8,e:"üá®üá≠"}, {n:"Denmark",v:5,e:"üá©üá∞"}, {n:"Finland",v:5,e:"üá´üáÆ"},
            {n:"Norway",v:5,e:"üá≥üá¥"}, {n:"New Zealand",v:5,e:"üá≥üáø"}, {n:"Ireland",v:5,e:"üáÆüá™"},
            {n:"Singapore",v:5,e:"üá∏üá¨"}, {n:"Iceland",v:0.4,e:"üáÆüá∏"}, {n:"Luxembourg",v:0.6,e:"üá±üá∫"}
        ],
        
        // Brand value (billions) - EXPANDED
        brands: [
            {n:"Apple",v:500,e:"üçé"}, {n:"Microsoft",v:410,e:"üíª"}, {n:"Amazon",v:380,e:"üì¶"},
            {n:"Google",v:350,e:"üîç"}, {n:"Samsung",v:100,e:"üì±"}, {n:"Coca-Cola",v:90,e:"ü•§"},
            {n:"Tesla",v:75,e:"üöó"}, {n:"Mercedes",v:65,e:"üöô"}, {n:"McDonald's",v:55,e:"üçî"},
            {n:"Disney",v:52,e:"üè∞"}, {n:"Nike",v:50,e:"üëü"}, {n:"BMW",v:45,e:"üèéÔ∏è"},
            {n:"Louis Vuitton",v:48,e:"üëú"}, {n:"Pepsi",v:20,e:"ü•§"}, {n:"Adidas",v:18,e:"‚öΩ"},
            {n:"Toyota",v:59,e:"üöô"}, {n:"Facebook",v:101,e:"üë•"}, {n:"Instagram",v:47,e:"üì∑"},
            {n:"Walmart",v:93,e:"üõí"}, {n:"Visa",v:191,e:"üí≥"}, {n:"Mastercard",v:108,e:"üí≥"},
            {n:"Intel",v:68,e:"üíæ"}, {n:"Netflix",v:28,e:"üì∫"}, {n:"Adobe",v:143,e:"üé®"},
            {n:"Oracle",v:88,e:"üíø"}, {n:"IBM",v:60,e:"üíº"}, {n:"Sony",v:45,e:"üéÆ"},
            {n:"Honda",v:33,e:"üèçÔ∏è"}, {n:"Ford",v:42,e:"üöô"}, {n:"Volkswagen",v:48,e:"üöó"},
            {n:"Audi",v:14,e:"üöó"}, {n:"Porsche",v:13,e:"üèéÔ∏è"}, {n:"Ferrari",v:9,e:"üèéÔ∏è"},
            {n:"Gucci",v:18,e:"üëú"}, {n:"Chanel",v:15,e:"üíÑ"}, {n:"Herm√®s",v:19,e:"üëú"},
            {n:"Rolex",v:10,e:"‚åö"}, {n:"Cartier",v:12,e:"üíç"}, {n:"Prada",v:9,e:"üëú"},
            {n:"Burberry",v:5,e:"üß•"}, {n:"Tiffany",v:6,e:"üíé"}, {n:"Zara",v:14,e:"üëó"},
            {n:"H&M",v:13,e:"üëî"}, {n:"Uniqlo",v:11,e:"üëï"}, {n:"IKEA",v:18,e:"üõãÔ∏è"},
            {n:"Starbucks",v:11,e:"‚òï"}, {n:"KFC",v:6,e:"üçó"}, {n:"Subway",v:5,e:"ü•™"},
            {n:"Pizza Hut",v:4,e:"üçï"}, {n:"Dominos",v:4,e:"üçï"}, {n:"Nestle",v:16,e:"üç´"}
        ],

        // Food calories (per 100g) - EXPANDED
        food: [
            {n:"Butter",v:717,e:"üßà"}, {n:"Peanuts",v:567,e:"ü•ú"}, {n:"Chocolate",v:546,e:"üç´"},
            {n:"Cheese",v:402,e:"üßÄ"}, {n:"Bread",v:265,e:"üçû"}, {n:"Pizza",v:266,e:"üçï"},
            {n:"Rice",v:130,e:"üçö"}, {n:"Pasta",v:131,e:"üçù"}, {n:"Banana",v:89,e:"üçå"},
            {n:"Apple",v:52,e:"üçé"}, {n:"Orange",v:47,e:"üçä"}, {n:"Carrot",v:41,e:"ü•ï"},
            {n:"Lettuce",v:15,e:"ü•¨"}, {n:"Cucumber",v:16,e:"ü•í"}, {n:"Watermelon",v:30,e:"üçâ"},
            {n:"Almonds",v:579,e:"üå∞"}, {n:"Walnuts",v:654,e:"ü•ú"}, {n:"Cashews",v:553,e:"ü•ú"},
            {n:"Avocado",v:160,e:"ü•ë"}, {n:"Bacon",v:541,e:"ü•ì"}, {n:"Sausage",v:346,e:"üå≠"},
            {n:"Chicken",v:239,e:"üçó"}, {n:"Beef",v:250,e:"ü•©"}, {n:"Salmon",v:208,e:"üêü"},
            {n:"Tuna",v:184,e:"üêü"}, {n:"Shrimp",v:99,e:"ü¶ê"}, {n:"Egg",v:155,e:"ü•ö"},
            {n:"Milk",v:61,e:"ü•õ"}, {n:"Yogurt",v:59,e:"ü•õ"}, {n:"Ice Cream",v:207,e:"üç¶"},
            {n:"Cake",v:257,e:"üç∞"}, {n:"Donut",v:452,e:"üç©"}, {n:"Cookie",v:502,e:"üç™"},
            {n:"Croissant",v:406,e:"ü•ê"}, {n:"Bagel",v:257,e:"ü•Ø"}, {n:"Pancake",v:227,e:"ü•û"},
            {n:"Waffle",v:291,e:"üßá"}, {n:"French Fries",v:312,e:"üçü"}, {n:"Burger",v:295,e:"üçî"},
            {n:"Hot Dog",v:290,e:"üå≠"}, {n:"Tacos",v:226,e:"üåÆ"}, {n:"Burrito",v:206,e:"üåØ"},
            {n:"Sushi",v:143,e:"üç£"}, {n:"Ramen",v:436,e:"üçú"}, {n:"Soup",v:38,e:"üç≤"},
            {n:"Salad",v:33,e:"ü•ó"}, {n:"Popcorn",v:387,e:"üçø"}, {n:"Honey",v:304,e:"üçØ"},
            {n:"Jam",v:278,e:"üçì"}, {n:"Mango",v:60,e:"ü•≠"}, {n:"Grapes",v:69,e:"üçá"},
            {n:"Strawberry",v:32,e:"üçì"}, {n:"Blueberry",v:57,e:"ü´ê"}, {n:"Peach",v:39,e:"üçë"},
            {n:"Pear",v:57,e:"üçê"}, {n:"Pineapple",v:50,e:"üçç"}, {n:"Kiwi",v:61,e:"ü•ù"}
        ],

        // Speed (km/h) - EXPANDED
        speed: [
            {n:"Cheetah",v:120,e:"üêÜ"}, {n:"Lion",v:80,e:"ü¶Å"}, {n:"Horse",v:88,e:"üê¥"},
            {n:"Ostrich",v:70,e:"ü¶©"}, {n:"Elephant",v:40,e:"üêò"}, {n:"Human",v:45,e:"üèÉ"},
            {n:"Turtle",v:1,e:"üê¢"}, {n:"Snail",v:0.05,e:"üêå"}, {n:"Sloth",v:0.27,e:"ü¶•"},
            {n:"Falcon",v:320,e:"ü¶Ö"}, {n:"Eagle",v:160,e:"ü¶Ö"}, {n:"Rabbit",v:56,e:"üêá"},
            {n:"Greyhound",v:72,e:"üêï"}, {n:"Kangaroo",v:71,e:"ü¶ò"}, {n:"Gazelle",v:97,e:"ü¶å"},
            {n:"Antelope",v:98,e:"ü¶å"}, {n:"Zebra",v:65,e:"ü¶ì"}, {n:"Giraffe",v:60,e:"ü¶í"},
            {n:"Bear",v:56,e:"üêª"}, {n:"Rhino",v:55,e:"ü¶è"}, {n:"Hippo",v:48,e:"ü¶õ"},
            {n:"Tiger",v:65,e:"üêÖ"}, {n:"Leopard",v:58,e:"üêÜ"}, {n:"Wolf",v:60,e:"üê∫"},
            {n:"Fox",v:50,e:"ü¶ä"}, {n:"Deer",v:48,e:"ü¶å"}, {n:"Moose",v:56,e:"ü¶å"},
            {n:"Crocodile",v:35,e:"üêä"}, {n:"Penguin",v:36,e:"üêß"}, {n:"Dolphin",v:60,e:"üê¨"},
            {n:"Shark",v:50,e:"ü¶à"}, {n:"Whale",v:48,e:"üêã"}, {n:"Squid",v:40,e:"ü¶ë"},
            {n:"Octopus",v:40,e:"üêô"}, {n:"Seal",v:35,e:"ü¶≠"}, {n:"Walrus",v:35,e:"ü¶≠"}
        ],

        // Box office (millions) - EXPANDED
        movies: [
            {n:"Avatar",v:2923,e:"üé¨"}, {n:"Avengers",v:2798,e:"ü¶∏"}, {n:"Titanic",v:2195,e:"üö¢"},
            {n:"Star Wars",v:2068,e:"‚≠ê"}, {n:"Jurassic World",v:1671,e:"ü¶ñ"}, {n:"Lion King",v:1663,e:"ü¶Å"},
            {n:"Frozen",v:1280,e:"‚ùÑÔ∏è"}, {n:"Harry Potter",v:1342,e:"‚ö°"}, {n:"Spider-Man",v:1921,e:"üï∑Ô∏è"},
            {n:"Top Gun",v:1488,e:"‚úàÔ∏è"}, {n:"Barbie",v:1445,e:"üíó"}, {n:"Mario",v:1355,e:"üçÑ"},
            {n:"Black Panther",v:1347,e:"üêæ"}, {n:"Frozen 2",v:1450,e:"‚ùÑÔ∏è"}, {n:"Incredibles",v:1242,e:"ü¶∏"},
            {n:"Finding Dory",v:1028,e:"üê†"}, {n:"Toy Story 4",v:1073,e:"ü§†"}, {n:"Joker",v:1074,e:"üÉè"},
            {n:"Aladdin",v:1050,e:"üßû"}, {n:"Aquaman",v:1148,e:"üî±"}, {n:"Bohemian",v:910,e:"üé∏"},
            {n:"The Batman",v:771,e:"ü¶á"}, {n:"Minions",v:1159,e:"üëæ"}, {n:"Beauty Beast",v:1263,e:"üåπ"},
            {n:"Finding Nemo",v:940,e:"üêü"}, {n:"Shrek 2",v:928,e:"üßå"}, {n:"Ice Age 3",v:886,e:"ü¶£"},
            {n:"Pirates 2",v:1066,e:"üè¥‚Äç‚ò†Ô∏è"}, {n:"Transformers",v:1123,e:"ü§ñ"}, {n:"Iron Man 3",v:1214,e:"ü¶æ"},
            {n:"Despicable 2",v:970,e:"üëæ"}, {n:"Skyfall",v:1108,e:"üî´"}, {n:"Matrix",v:1632,e:"üï∂Ô∏è"}
        ],

        // Temperature (avg ¬∞C) - EXPANDED
        places: [
            {n:"Sahara",t:30,e:"üèúÔ∏è"}, {n:"Dubai",t:28,e:"üèôÔ∏è"}, {n:"Bangkok",t:28,e:"üå¥"},
            {n:"Egypt",t:22,e:"üèõÔ∏è"}, {n:"Spain",t:17,e:"üá™üá∏"}, {n:"London",t:11,e:"üåßÔ∏è"},
            {n:"Moscow",t:6,e:"‚ùÑÔ∏è"}, {n:"Antarctica",t:-57,e:"üßä"}, {n:"Iceland",t:5,e:"üåã"},
            {n:"Alaska",t:-3,e:"üêª"}, {n:"Amazon",t:26,e:"üå≥"}, {n:"Australia",t:21,e:"ü¶ò"},
            {n:"India",t:25,e:"üáÆüá≥"}, {n:"Brazil",t:24,e:"üáßüá∑"}, {n:"Mexico",t:21,e:"üá≤üáΩ"},
            {n:"Miami",t:24,e:"üèñÔ∏è"}, {n:"LA",t:18,e:"üå¥"}, {n:"New York",t:13,e:"üóΩ"},
            {n:"Tokyo",t:16,e:"üóº"}, {n:"Singapore",t:27,e:"üåÜ"}, {n:"Hong Kong",t:23,e:"üèôÔ∏è"},
            {n:"Paris",t:12,e:"üóº"}, {n:"Berlin",t:10,e:"üá©üá™"}, {n:"Rome",t:16,e:"üèõÔ∏è"},
            {n:"Athens",t:18,e:"üèõÔ∏è"}, {n:"Stockholm",t:7,e:"üá∏üá™"}, {n:"Oslo",t:6,e:"üá≥üá¥"},
            {n:"Helsinki",t:6,e:"üá´üáÆ"}, {n:"Toronto",t:9,e:"üçÅ"}, {n:"Vancouver",t:11,e:"üçÅ"},
            {n:"Sydney",t:18,e:"ü¶ò"}, {n:"Melbourne",t:15,e:"ü¶ò"}, {n:"Cape Town",t:17,e:"üåç"},
            {n:"Cairo",t:22,e:"üèõÔ∏è"}, {n:"Tel Aviv",t:20,e:"üèñÔ∏è"}, {n:"Istanbul",t:14,e:"üïå"}
        ],

        // YouTube views (billions) - EXPANDED
        youtube: [
            {n:"Baby Shark",v:13.5,e:"ü¶à"}, {n:"Despacito",v:8.2,e:"üéµ"}, {n:"Shape of You",v:6.1,e:"üé∂"},
            {n:"See You Again",v:6.0,e:"üöó"}, {n:"Uptown Funk",v:4.8,e:"üï∫"}, {n:"Gangnam Style",v:4.7,e:"üê¥"},
            {n:"Sorry",v:3.6,e:"üé§"}, {n:"Roar",v:3.8,e:"ü¶Å"}, {n:"Shake It Off",v:3.3,e:"üíÉ"},
            {n:"Bailando",v:3.5,e:"üíÉ"}, {n:"Thinking Out Loud",v:3.7,e:"üéµ"}, {n:"Counting Stars",v:3.8,e:"‚≠ê"},
            {n:"Dark Horse",v:3.2,e:"üê¥"}, {n:"Lean On",v:3.1,e:"üé∂"}, {n:"Hello",v:3.3,e:"üëã"},
            {n:"Sugar",v:3.7,e:"üç≠"}, {n:"Roar",v:3.8,e:"üéµ"}, {n:"Girls Like You",v:3.3,e:"üíï"},
            {n:"Closer",v:3.3,e:"üéµ"}, {n:"Faded",v:3.5,e:"üé∂"}, {n:"Let Her Go",v:3.5,e:"üéµ"},
            {n:"Waka Waka",v:3.6,e:"‚öΩ"}, {n:"Blank Space",v:3.2,e:"üìù"}, {n:"Work",v:3.0,e:"üéµ"}
        ],

        // Sports ball size (diameter cm) - EXPANDED
        sports: [
            {n:"Basketball",s:24,e:"üèÄ"}, {n:"Soccer",s:22,e:"‚öΩ"}, {n:"Volleyball",s:21,e:"üèê"},
            {n:"Tennis",s:6.7,e:"üéæ"}, {n:"Baseball",s:7.3,e:"‚öæ"}, {n:"Golf",s:4.3,e:"‚õ≥"},
            {n:"Table Tennis",s:4.0,e:"üèì"}, {n:"Bowling",s:21.6,e:"üé≥"},
            {n:"Softball",s:9.7,e:"ü•é"}, {n:"Cricket",s:7.2,e:"üèè"}, {n:"Rugby",s:28,e:"üèâ"},
            {n:"Handball",s:19,e:"ü§æ"}, {n:"Water Polo",s:22,e:"ü§Ω"}, {n:"Lacrosse",s:6.3,e:"ü•ç"},
            {n:"Field Hockey",s:7.1,e:"üèë"}, {n:"Squash",s:4.0,e:"üéæ"}, {n:"Badminton",s:6.7,e:"üè∏"}
        ],

        // Building height (meters) - EXPANDED
        buildings: [
            {n:"Burj Khalifa",v:828,e:"üè¢"}, {n:"Shanghai Tower",v:632,e:"üèôÔ∏è"}, {n:"Mecca Clock",v:601,e:"üïå"},
            {n:"Ping An",v:599,e:"üèõÔ∏è"}, {n:"Lotte Tower",v:555,e:"üóº"}, {n:"One WTC",v:541,e:"üèôÔ∏è"},
            {n:"CN Tower",v:553,e:"üì°"}, {n:"Empire State",v:443,e:"üè¢"}, {n:"Eiffel Tower",v:330,e:"üóº"},
            {n:"Big Ben",v:96,e:"üï∞Ô∏è"}, {n:"Statue Liberty",v:93,e:"üóΩ"},
            {n:"Tokyo Skytree",v:634,e:"üóº"}, {n:"Willis Tower",v:442,e:"üè¢"}, {n:"Taipei 101",v:508,e:"üè¢"},
            {n:"Petronas",v:452,e:"üèôÔ∏è"}, {n:"Sears Tower",v:442,e:"üè¢"}, {n:"Jin Mao",v:421,e:"üèôÔ∏è"},
            {n:"Two IFC",v:412,e:"üè¢"}, {n:"Trump Tower",v:423,e:"üè¢"}, {n:"Chrysler",v:319,e:"üè¢"},
            {n:"Shard",v:310,e:"üèôÔ∏è"}, {n:"Transamerica",v:260,e:"üè¢"}, {n:"Gherkin",v:180,e:"üèôÔ∏è"},
            {n:"Space Needle",v:184,e:"üóº"}, {n:"Leaning Tower",v:56,e:"üóº"}, {n:"Arc Triomphe",v:50,e:"üèõÔ∏è"}
        ],

        // Planet data (distance from sun in million km) - EXPANDED
        planets: [
            {n:"Mercury",v:58,e:"‚òøÔ∏è"}, {n:"Venus",v:108,e:"‚ôÄÔ∏è"}, {n:"Earth",v:150,e:"üåç"},
            {n:"Mars",v:228,e:"‚ôÇÔ∏è"}, {n:"Jupiter",v:778,e:"‚ôÉ"}, {n:"Saturn",v:1427,e:"‚ôÑ"},
            {n:"Uranus",v:2871,e:"‚ôÖ"}, {n:"Neptune",v:4497,e:"‚ôÜ"},
            {n:"Moon",v:0.384,e:"üåô"}, {n:"Pluto",v:5906,e:"ü™ê"}, {n:"Ceres",v:414,e:"‚òÑÔ∏è"}
        ],

        // Ocean depth (average meters) - EXPANDED
        oceans: [
            {n:"Pacific",v:4280,e:"üåä"}, {n:"Atlantic",v:3646,e:"üåä"}, {n:"Indian",v:3741,e:"üåä"},
            {n:"Southern",v:3270,e:"üåä"}, {n:"Arctic",v:1205,e:"üßä"}, {n:"Mediterranean",v:1500,e:"‚õµ"},
            {n:"Caribbean",v:2647,e:"üèùÔ∏è"}, {n:"South China",v:1652,e:"üåä"}, {n:"Bering Sea",v:1547,e:"üåä"},
            {n:"Gulf Mexico",v:1486,e:"üåä"}, {n:"Sea of Japan",v:1752,e:"üåä"}, {n:"Red Sea",v:491,e:"üåä"},
            {n:"Baltic Sea",v:55,e:"üåä"}, {n:"Black Sea",v:1240,e:"üåä"}, {n:"Dead Sea",v:304,e:"üåä"}
        ],

        // Animal lifespan (years) - EXPANDED
        animals: [
            {n:"Turtle",v:100,e:"üê¢"}, {n:"Elephant",v:70,e:"üêò"}, {n:"Parrot",v:80,e:"ü¶ú"},
            {n:"Eagle",v:50,e:"ü¶Ö"}, {n:"Lion",v:15,e:"ü¶Å"}, {n:"Dog",v:13,e:"üêï"},
            {n:"Cat",v:15,e:"üêà"}, {n:"Rabbit",v:9,e:"üêá"}, {n:"Mouse",v:2,e:"üê≠"},
            {n:"Butterfly",v:0.5,e:"ü¶ã"}, {n:"Bee",v:0.15,e:"üêù"},
            {n:"Whale",v:90,e:"üêã"}, {n:"Gorilla",v:40,e:"ü¶ç"}, {n:"Chimpanzee",v:50,e:"üêµ"},
            {n:"Crocodile",v:70,e:"üêä"}, {n:"Shark",v:70,e:"ü¶à"}, {n:"Penguin",v:20,e:"üêß"},
            {n:"Horse",v:30,e:"üê¥"}, {n:"Cow",v:20,e:"üêÑ"}, {n:"Pig",v:15,e:"üê∑"},
            {n:"Chicken",v:8,e:"üêî"}, {n:"Duck",v:10,e:"ü¶Ü"}, {n:"Goose",v:20,e:"ü¶¢"},
            {n:"Kangaroo",v:23,e:"ü¶ò"}, {n:"Koala",v:18,e:"üê®"}, {n:"Panda",v:20,e:"üêº"},
            {n:"Tiger",v:20,e:"üêÖ"}, {n:"Leopard",v:17,e:"üêÜ"}, {n:"Cheetah",v:12,e:"üêÜ"},
            {n:"Wolf",v:13,e:"üê∫"}, {n:"Fox",v:10,e:"ü¶ä"}, {n:"Bear",v:25,e:"üêª"}
        ],

        // Tech company founded year - EXPANDED
        tech: [
            {n:"IBM",v:1911,e:"üíº"}, {n:"HP",v:1939,e:"üñ®Ô∏è"}, {n:"Microsoft",v:1975,e:"üíª"},
            {n:"Apple",v:1976,e:"üçé"}, {n:"Amazon",v:1994,e:"üì¶"}, {n:"Google",v:1998,e:"üîç"},
            {n:"Facebook",v:2004,e:"üë•"}, {n:"YouTube",v:2005,e:"üìπ"}, {n:"Twitter",v:2006,e:"üê¶"},
            {n:"Instagram",v:2010,e:"üì∑"}, {n:"TikTok",v:2016,e:"üéµ"},
            {n:"Sony",v:1946,e:"üéÆ"}, {n:"Samsung",v:1938,e:"üì±"}, {n:"Intel",v:1968,e:"üíæ"},
            {n:"Adobe",v:1982,e:"üé®"}, {n:"Oracle",v:1977,e:"üíø"}, {n:"Netflix",v:1997,e:"üì∫"},
            {n:"eBay",v:1995,e:"üõí"}, {n:"PayPal",v:1998,e:"üí≥"}, {n:"Spotify",v:2006,e:"üéµ"},
            {n:"Uber",v:2009,e:"üöó"}, {n:"Airbnb",v:2008,e:"üè†"}, {n:"Tesla",v:2003,e:"‚ö°"},
            {n:"SpaceX",v:2002,e:"üöÄ"}, {n:"Nvidia",v:1993,e:"üéÆ"}, {n:"AMD",v:1969,e:"üíæ"},
            {n:"Dell",v:1984,e:"üíª"}, {n:"Cisco",v:1984,e:"üåê"}, {n:"Salesforce",v:1999,e:"‚òÅÔ∏è"}
        ],

        // Musical notes frequency (Hz) - EXPANDED
        notes: [
            {n:"C",v:262,e:"üéµ"}, {n:"D",v:294,e:"üéµ"}, {n:"E",v:330,e:"üéµ"},
            {n:"F",v:349,e:"üéµ"}, {n:"G",v:392,e:"üéµ"}, {n:"A",v:440,e:"üéµ"},
            {n:"B",v:494,e:"üéµ"}, {n:"C#",v:277,e:"üéµ"}, {n:"D#",v:311,e:"üéµ"},
            {n:"F#",v:370,e:"üéµ"}, {n:"G#",v:415,e:"üéµ"}, {n:"A#",v:466,e:"üéµ"}
        ],

        // Book pages (approximate) - EXPANDED
        books: [
            {n:"Bible",v:1200,e:"üìñ"}, {n:"War & Peace",v:1225,e:"üìö"}, {n:"Harry Potter 7",v:607,e:"‚ö°"},
            {n:"Lord of Rings",v:1178,e:"üíç"}, {n:"Game of Thrones",v:694,e:"üëë"}, {n:"1984",v:328,e:"üìï"},
            {n:"Great Gatsby",v:180,e:"üìó"}, {n:"Animal Farm",v:112,e:"üìò"},
            {n:"Hobbit",v:310,e:"üßô"}, {n:"Dune",v:688,e:"üèúÔ∏è"}, {n:"Moby Dick",v:635,e:"üêã"},
            {n:"Ulysses",v:732,e:"üìö"}, {n:"Don Quixote",v:863,e:"üó°Ô∏è"}, {n:"Odyssey",v:541,e:"‚õµ"},
            {n:"Pride Prejudice",v:432,e:"üíï"}, {n:"Catcher Rye",v:277,e:"üìï"}, {n:"Brave New",v:311,e:"üìó"},
            {n:"Fahrenheit 451",v:249,e:"üî•"}, {n:"To Kill Bird",v:324,e:"üê¶"}, {n:"Grapes Wrath",v:464,e:"üçá"}
        ],

        // Currency value vs USD - EXPANDED
        currency: [
            {n:"Kuwait Dinar",v:3.26,e:"üíµ"}, {n:"British Pound",v:1.27,e:"üí∑"}, {n:"Euro",v:1.08,e:"üí∂"},
            {n:"US Dollar",v:1.00,e:"üíµ"}, {n:"Canadian Dollar",v:0.74,e:"üçÅ"}, {n:"Indian Rupee",v:0.012,e:"üáÆüá≥"},
            {n:"Japanese Yen",v:0.0067,e:"üí¥"}, {n:"Egyptian Pound",v:0.032,e:"üá™üá¨"},
            {n:"Swiss Franc",v:1.12,e:"üá®üá≠"}, {n:"Australian Dollar",v:0.66,e:"ü¶ò"}, {n:"Singapore Dollar",v:0.74,e:"ü¶Å"},
            {n:"UAE Dirham",v:0.27,e:"üê™"}, {n:"Saudi Riyal",v:0.27,e:"üïå"}, {n:"South African Rand",v:0.055,e:"ü¶Å"},
            {n:"Brazilian Real",v:0.20,e:"üáßüá∑"}, {n:"Mexican Peso",v:0.050,e:"üåÆ"}, {n:"Chinese Yuan",v:0.14,e:"üêâ"},
            {n:"Russian Ruble",v:0.010,e:"üêª"}, {n:"Turkish Lira",v:0.029,e:"ü¶É"}, {n:"Korean Won",v:0.00075,e:"üá∞üá∑"}
        ]
    };

    // ========== CATEGORY DEFINITIONS ==========
    const CATEGORIES = [
        {
            id: 'population',
            name: 'Population',
            icon: 'üåç',
            desc: 'Country populations',
            type: 'knowledge',
            fn: () => compare(DB.countries, 'v', 'MORE PEOPLE')
        },
        {
            id: 'brands',
            name: 'Brand Value',
            icon: 'üíé',
            desc: 'Company worth',
            type: 'knowledge',
            fn: () => compare(DB.brands, 'v', 'BIGGER BRAND')
        },
        {
            id: 'food',
            name: 'Calories',
            icon: 'üçî',
            desc: 'Food calories',
            type: 'knowledge',
            fn: () => compare(DB.food, 'v', 'MORE CALORIES')
        },
        {
            id: 'speed',
            name: 'Speed',
            icon: '‚ö°',
            desc: 'Animal speed',
            type: 'knowledge',
            fn: () => compare(DB.speed, 'v', 'FASTER')
        },
        {
            id: 'movies',
            name: 'Box Office',
            icon: 'üé¨',
            desc: 'Movie earnings',
            type: 'knowledge',
            fn: () => compare(DB.movies, 'v', 'BIGGER MOVIE')
        },
        {
            id: 'temperature',
            name: 'Temperature',
            icon: 'üå°Ô∏è',
            desc: 'Climate comparison',
            type: 'knowledge',
            fn: () => compare(DB.places, 't', 'HOTTER PLACE')
        },
        {
            id: 'youtube',
            name: 'YouTube',
            icon: 'üìπ',
            desc: 'Video views',
            type: 'knowledge',
            fn: () => compare(DB.youtube, 'v', 'MORE VIEWS')
        },
        {
            id: 'sports',
            name: 'Ball Size',
            icon: '‚öΩ',
            desc: 'Sports balls',
            type: 'knowledge',
            fn: () => compare(DB.sports, 's', 'BIGGER BALL')
        },
        {
            id: 'buildings',
            name: 'Buildings',
            icon: 'üè¢',
            desc: 'Structure height',
            type: 'knowledge',
            fn: () => compare(DB.buildings, 'v', 'TALLER BUILDING')
        },
        {
            id: 'planets',
            name: 'Solar System',
            icon: 'ü™ê',
            desc: 'Distance from sun',
            type: 'knowledge',
            fn: () => compare(DB.planets, 'v', 'FARTHER FROM SUN')
        },
        {
            id: 'oceans',
            name: 'Ocean Depth',
            icon: 'üåä',
            desc: 'Average depth',
            type: 'knowledge',
            fn: () => compare(DB.oceans, 'v', 'DEEPER OCEAN')
        },
        {
            id: 'animals',
            name: 'Lifespan',
            icon: 'üêò',
            desc: 'Animal age',
            type: 'knowledge',
            fn: () => compare(DB.animals, 'v', 'LIVES LONGER')
        },
        {
            id: 'tech',
            name: 'Tech History',
            icon: 'üíª',
            desc: 'Founded year',
            type: 'knowledge',
            fn: () => compare(DB.tech, 'v', 'FOUNDED EARLIER')
        },
        {
            id: 'books',
            name: 'Book Length',
            icon: 'üìö',
            desc: 'Page count',
            type: 'knowledge',
            fn: () => compare(DB.books, 'v', 'MORE PAGES')
        },
        {
            id: 'currency',
            name: 'Currency',
            icon: 'üí±',
            desc: 'Value vs USD',
            type: 'knowledge',
            fn: () => compare(DB.currency, 'v', 'STRONGER CURRENCY')
        },
        {
            id: 'math_add',
            name: 'Addition',
            icon: '‚ûï',
            desc: 'Quick math',
            type: 'math',
            fn: () => {
                const n1 = r(30) + 1, n2 = r(30) + 1;
                return mathGen(n1 + n2, `${n1} + ${n2}`);
            }
        },
        {
            id: 'math_sub',
            name: 'Subtraction',
            icon: '‚ûñ',
            desc: 'Quick math',
            type: 'math',
            fn: () => {
                const n1 = r(40) + 20, n2 = r(20) + 1;
                return mathGen(n1 - n2, `${n1} - ${n2}`);
            }
        },
        {
            id: 'math_mul',
            name: 'Multiply',
            icon: '‚úñÔ∏è',
            desc: 'Quick math',
            type: 'math',
            fn: () => {
                const n1 = r(12) + 2, n2 = r(12) + 2;
                return mathGen(n1 * n2, `${n1} √ó ${n2}`);
            }
        },
        {
            id: 'stroop',
            name: 'Color Focus',
            icon: 'üé®',
            desc: 'Text vs color',
            type: 'logic',
            fn: () => {
                const colors = [
                    {n:'RED', h:'#ff4444'}, {n:'BLUE', h:'#4488ff'}, 
                    {n:'GREEN', h:'#44ff44'}, {n:'YELLOW', h:'#ffff44'}
                ];
                const target = colors[r(colors.length)];
                const wrongColor = colors.filter(c => c.n !== target.n)[r(colors.length - 1)];
                return {
                    l: "FOCUS",
                    p: `TEXT IS "${target.n}"`,
                    wHTML: `<div class="text-mode" style="color:${wrongColor.h}">${target.n}</div>`,
                    lHTML: `<div class="text-mode" style="color:${target.h}">${colors.filter(c => c.n !== target.n)[r(colors.length - 1)].n}</div>`
                };
            }
        },
        {
            id: 'direction',
            name: 'Direction',
            icon: 'üß≠',
            desc: 'Arrow direction',
            type: 'logic',
            fn: () => {
                const dirs = [
                    {n:'UP', e:'‚¨ÜÔ∏è'}, {n:'DOWN', e:'‚¨áÔ∏è'}, 
                    {n:'LEFT', e:'‚¨ÖÔ∏è'}, {n:'RIGHT', e:'‚û°Ô∏è'}
                ];
                const target = dirs[r(dirs.length)];
                const wrong = dirs.filter(d => d.n !== target.n)[r(dirs.length - 1)];
                return {
                    l: "DIRECTION",
                    p: target.n,
                    wHTML: `<div class="emoji-mode">${target.e}</div>`,
                    lHTML: `<div class="emoji-mode">${wrong.e}</div>`
                };
            }
        },
        {
            id: 'emotion',
            name: 'Emotions',
            icon: 'üòä',
            desc: 'Facial expressions',
            type: 'logic',
            fn: () => {
                const emos = [
                    {n:'HAPPY', e:'üòÑ'}, {n:'SAD', e:'üò¢'}, 
                    {n:'ANGRY', e:'üò†'}, {n:'SURPRISED', e:'üòÆ'}
                ];
                const target = emos[r(emos.length)];
                const wrong = emos.filter(e => e.n !== target.n)[r(emos.length - 1)];
                return {
                    l: "EMOTION",
                    p: target.n,
                    wHTML: `<div class="emoji-mode">${target.e}</div>`,
                    lHTML: `<div class="emoji-mode">${wrong.e}</div>`
                };
            }
        },
        {
            id: 'shapes',
            name: 'Shapes',
            icon: 'üî∑',
            desc: 'Geometric shapes',
            type: 'logic',
            fn: () => {
                const shapes = [
                    {n:'CIRCLE', e:'‚≠ï'}, {n:'SQUARE', e:'üü¶'}, 
                    {n:'TRIANGLE', e:'üî∫'}, {n:'STAR', e:'‚≠ê'}
                ];
                const target = shapes[r(shapes.length)];
                const wrong = shapes.filter(s => s.n !== target.n)[r(shapes.length - 1)];
                return {
                    l: "SHAPE",
                    p: target.n,
                    wHTML: `<div class="emoji-mode">${target.e}</div>`,
                    lHTML: `<div class="emoji-mode">${wrong.e}</div>`
                };
            }
        },
        {
            id: 'odd_even',
            name: 'Odd/Even',
            icon: 'üî¢',
            desc: 'Number type',
            type: 'logic',
            fn: () => {
                const num = r(100) + 1;
                const isEven = num % 2 === 0;
                return {
                    l: "NUMBER TYPE",
                    p: isEven ? "EVEN NUMBER" : "ODD NUMBER",
                    wHTML: `<div class="entity math-mode">${num}</div>`,
                    lHTML: `<div class="entity math-mode">${isEven ? num + 1 : num - 1}</div>`
                };
            }
        },
        {
            id: 'greater_less',
            name: 'Greater/Less',
            icon: '‚öñÔ∏è',
            desc: 'Number comparison',
            type: 'logic',
            fn: () => {
                const n1 = r(50) + 10;
                const n2 = r(50) + 10;
                if (n1 === n2) return CATEGORIES.find(c => c.id === 'greater_less').fn();
                const greater = Math.max(n1, n2);
                const lesser = Math.min(n1, n2);
                return {
                    l: "COMPARISON",
                    p: "GREATER NUMBER",
                    wHTML: `<div class="entity math-mode">${greater}</div>`,
                    lHTML: `<div class="entity math-mode">${lesser}</div>`
                };
            }
        }
    ];

    // Helper functions
    function compare(arr, prop, label) {
        const shuffled = [...arr].sort(() => Math.random() - 0.5);
        let a = shuffled[0];
        let b = shuffled[1];
        
        // Ensure different items
        let attempts = 0;
        while ((a.n === b.n || a[prop] === b[prop]) && attempts < 20) {
            b = shuffled[r(shuffled.length)];
            attempts++;
        }
        
        const win = a[prop] > b[prop] ? a : b;
        const lose = a[prop] > b[prop] ? b : a;

        return {
            l: "KNOWLEDGE",
            p: label,
            wHTML: `<div class="entity emoji-mode">${win.e}</div><div class="sub-text">${win.n}</div>`,
            lHTML: `<div class="entity emoji-mode">${lose.e}</div><div class="sub-text">${lose.n}</div>`
        };
    }

    function mathGen(ans, q) {
        let fake = ans + (Math.random() > 0.5 ? r(5) + 1 : -(r(5) + 1));
        // Ensure different
        if (fake === ans) fake = ans + 3;
        return {
            l: "MATH",
            p: q,
            wHTML: `<div class="entity math-mode">${ans}</div>`,
            lHTML: `<div class="entity math-mode">${fake}</div>`
        };
    }

    function r(n) { return Math.floor(Math.random() * n); }

    // ========== GAME ENGINE ==========
    const Game = {
        active: false,
        score: 0,
        streak: 0,
        bestStreak: 0,
        timer: 100,
        difficulty: 'normal',
        selectedCategories: [],
        categoryBag: [],
        correctSide: null,
        loopId: null,
        isPaused: false,
        hintsRemaining: 1,
        hintUsedThisRound: false,

        dom: {
            timer: document.getElementById('timer'),
            score: document.getElementById('score'),
            streak: document.getElementById('streak'),
            flow: document.getElementById('flow'),
            pLabel: document.getElementById('p-label'),
            pMain: document.getElementById('p-main'),
            left: document.getElementById('ent-left'),
            right: document.getElementById('ent-right'),
            startScreen: document.getElementById('start-screen'),
            categoryScreen: document.getElementById('category-screen'),
            infoScreen: document.getElementById('info-screen'),
            endScreen: document.getElementById('end-screen'),
            pauseScreen: document.getElementById('pause-screen'),
            layout: document.getElementById('layout'),
            final: document.getElementById('final-score'),
            reason: document.getElementById('end-reason'),
            statsDisplay: document.getElementById('stats-display'),
            hintBtn: document.getElementById('hint-btn'),
            categoryGrid: document.getElementById('category-grid'),
            selectionSummary: document.getElementById('selection-summary'),
            selectedCount: document.getElementById('selected-count')
        },

        showCategorySelection() {
            this.dom.startScreen.classList.add('hidden');
            this.dom.categoryScreen.classList.remove('hidden');
            this.renderCategories();
            this.updateSelectionSummary();
        },

        renderCategories() {
            this.dom.categoryGrid.innerHTML = CATEGORIES.map(cat => `
                <div class="category-card" data-id="${cat.id}" onclick="Game.toggleCategory('${cat.id}')">
                    <div class="category-icon">${cat.icon}</div>
                    <div class="category-name">${cat.name}</div>
                    <div class="category-desc">${cat.desc}</div>
                </div>
            `).join('');
        },

        toggleCategory(id) {
            const idx = this.selectedCategories.indexOf(id);
            const card = document.querySelector(`[data-id="${id}"]`);
            
            if (idx > -1) {
                this.selectedCategories.splice(idx, 1);
                card.classList.remove('selected');
            } else {
                this.selectedCategories.push(id);
                card.classList.add('selected');
            }
            
            this.updateSelectionSummary();
        },

        selectAllCategories() {
            this.selectedCategories = CATEGORIES.map(c => c.id);
            document.querySelectorAll('.category-card').forEach(card => card.classList.add('selected'));
            this.updateSelectionSummary();
        },

        clearCategories() {
            this.selectedCategories = [];
            document.querySelectorAll('.category-card').forEach(card => card.classList.remove('selected'));
            this.updateSelectionSummary();
        },

        selectRandom(count) {
            this.clearCategories();
            const shuffled = [...CATEGORIES].sort(() => Math.random() - 0.5);
            for (let i = 0; i < Math.min(count, shuffled.length); i++) {
                this.toggleCategory(shuffled[i].id);
            }
        },

        selectByType(type) {
            this.clearCategories();
            const filtered = CATEGORIES.filter(c => c.type === type);
            filtered.forEach(cat => this.toggleCategory(cat.id));
        },

        updateSelectionSummary() {
            this.dom.selectedCount.textContent = this.selectedCategories.length;
        },

        setDifficulty(level) {
            this.difficulty = level;
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.toggle('selected', btn.dataset.difficulty === level);
            });
        },

        startWithSelection() {
            if (this.selectedCategories.length === 0) {
                alert('Please select at least one category!');
                return;
            }
            this.start();
        },

        start() {
            // If no categories selected, use all
            if (this.selectedCategories.length === 0) {
                this.selectedCategories = CATEGORIES.map(c => c.id);
            }

            this.active = true;
            this.score = 0;
            this.streak = 0;
            this.bestStreak = 0;
            this.timer = 100;
            this.categoryBag = [];
            this.isPaused = false;
            this.hintsRemaining = 1;
            this.hintUsedThisRound = false;

            // Hide all overlays and show game
            this.dom.startScreen.classList.add('hidden');
            this.dom.categoryScreen.classList.add('hidden');
            this.dom.endScreen.classList.add('hidden');
            this.dom.pauseScreen.classList.add('hidden');
            this.dom.layout.classList.remove('hidden');

            this.updateHUD();
            this.nextRound();
            
            if (this.loopId) cancelAnimationFrame(this.loopId);
            this.loop();
        },

        loop() {
            if (!this.active || this.isPaused) return;
            
            // Difficulty-based speed
            let baseSpeed = 0.25;
            if (this.difficulty === 'hard') baseSpeed = 0.35;
            if (this.difficulty === 'extreme') baseSpeed = 0.5;
            
            const speed = baseSpeed + (this.score * 0.005);
            this.timer -= speed;
            this.dom.timer.style.transform = `scaleX(${Math.max(0, this.timer / 100)})`;
            
            // Color warning
            if (this.timer < 30) this.dom.timer.style.background = 'var(--gold)';
            else this.dom.timer.style.background = 'var(--text)';

            if (this.timer <= 0) this.over("TIME OUT");
            else this.loopId = requestAnimationFrame(() => this.loop());
        },

        input(side) {
            if (!this.active || this.isPaused) return;
            
            if (side === this.correctSide) {
                this.score++;
                this.streak++;
                this.bestStreak = Math.max(this.bestStreak, this.streak);
                this.timer = 100; // Full reset
                this.hintUsedThisRound = false;
                
                AudioEngine.hit();
                this.spawnParticles(side);
                this.updateHUD();
                this.nextRound();
            } else {
                this.over("WRONG CHOICE");
            }
        },

        useHint() {
            if (this.hintsRemaining === 0 || this.hintUsedThisRound) return;
            
            this.hintsRemaining--;
            this.hintUsedThisRound = true;
            AudioEngine.hint();
            
            // Highlight wrong answer with subtle effect
            const wrongSide = this.correctSide === 'left' ? 'right' : 'left';
            const wrongElem = this.correctSide === 'left' ? this.dom.right : this.dom.left;
            
            wrongElem.style.opacity = '0.3';
            setTimeout(() => {
                wrongElem.style.opacity = '1';
            }, 1000);
            
            this.dom.hintBtn.classList.add('used');
            this.dom.hintBtn.textContent = 'üí° HINT (0)';
        },

        pause() {
            if (!this.active) return;
            this.isPaused = true;
            this.dom.pauseScreen.classList.remove('hidden');
        },

        resume() {
            this.isPaused = false;
            this.dom.pauseScreen.classList.add('hidden');
            this.loop();
        },

        quitToMenu() {
            this.active = false;
            this.isPaused = false;
            this.backToStart();
        },

        over(msg) {
            this.active = false;
            AudioEngine.fail();
            
            this.dom.final.innerText = this.score;
            this.dom.reason.innerText = msg;
            this.dom.statsDisplay.innerHTML = `
                Best Streak: ${this.bestStreak} üî•<br>
                Difficulty: ${this.difficulty.toUpperCase()}<br>
                Categories: ${this.selectedCategories.length}
            `;
            
            this.dom.layout.classList.add('hidden');
            this.dom.endScreen.classList.remove('hidden');
        },

        updateHUD() {
            this.dom.score.innerText = this.score;
            this.dom.streak.innerText = `üî• ${this.streak} Streak`;
            
            if (this.score >= 10) this.dom.flow.classList.add('active');
            else this.dom.flow.classList.remove('active');
        },

        spawnParticles(side) {
            const rect = (side === 'left' ? this.dom.left : this.dom.right).getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            for (let i = 0; i < 10; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = x + 'px';
                p.style.top = y + 'px';
                p.style.width = (Math.random() * 10 + 5) + 'px';
                p.style.height = p.style.width;
                p.style.background = `hsl(${Math.random() * 360}, 100%, 60%)`;
                
                const ang = Math.random() * Math.PI * 2;
                const dist = Math.random() * 80 + 40;
                p.style.setProperty('--dx', Math.cos(ang) * dist + 'px');
                p.style.setProperty('--dy', Math.sin(ang) * dist + 'px');
                
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 600);
            }
        },

        nextRound() {
            this.dom.left.innerHTML = '';
            this.dom.right.innerHTML = '';
            
            // Refill bag if empty
            if (this.categoryBag.length === 0) {
                this.categoryBag = [...this.selectedCategories];
                this.categoryBag.sort(() => Math.random() - 0.5);
            }
            
            const catId = this.categoryBag.pop();
            const category = CATEGORIES.find(c => c.id === catId);
            
            if (!category) {
                console.error('Category not found:', catId);
                return;
            }
            
            const data = category.fn();
            const isLeft = Math.random() > 0.5;
            this.correctSide = isLeft ? 'left' : 'right';

            this.dom.pLabel.innerText = data.l;
            this.dom.pMain.innerText = data.p;
            this.dom.left.innerHTML = isLeft ? data.wHTML : data.lHTML;
            this.dom.right.innerHTML = isLeft ? data.lHTML : data.wHTML;
        },

        restart() {
            this.start();
        },

        backToStart() {
            this.dom.categoryScreen.classList.add('hidden');
            this.dom.endScreen.classList.add('hidden');
            this.dom.pauseScreen.classList.add('hidden');
            this.dom.layout.classList.add('hidden');
            this.dom.startScreen.classList.remove('hidden');
        },

        showInfo() {
            this.dom.startScreen.classList.add('hidden');
            this.dom.infoScreen.classList.remove('hidden');
        },

        hideInfo() {
            this.dom.infoScreen.classList.add('hidden');
            this.dom.startScreen.classList.remove('hidden');
        }
    };
</script>
</body>
</html>
